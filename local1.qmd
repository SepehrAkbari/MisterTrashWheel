---
title: "Untitled"
subtitle: "A Quarto document"
author: "Sepehr Akbari"
date: "2024-10-16"
abstract: "This is a simple Quarto document."
format:
  html:
    theme: united
    toc: true
    code-fold: true
    abstract-title: "Research Focus"
embed-resources: true
editor_options: 
  chunk_output_type: console
---

## Setup: Collecting The Garbage

```{r}
library(tidyverse)
library(gt)
```

```{r}
trash_wheel <- read_csv("Data/trash_wheel.csv")
```

## Unveiling The Waste Stream

```{r}
trash_wheel <- trash_wheel %>% 
  mutate(ID = tolower(ID)) %>% 
  filter(ID == "mister")
```

## Breaking Down The Debris

```{r}
trash_wheel <- trash_wheel %>%
  mutate(
    Month = tolower(Month),
    Season = case_when(
      Month %in% c("december", "january", "february") ~ "Winter",
      Month %in% c("march", "april", "may") ~ "Spring",
      Month %in% c("june", "july", "august") ~ "Summer",
      Month %in% c("september", "october", "november") ~ "Fall"
    )
  )
```

```{r}
trash_wheel <- trash_wheel %>%
  mutate(
    IsWeekend = ifelse(weekdays(Date) %in% c("Saturday", "Sunday"), TRUE, FALSE) 
  )
```

```{r}
trash_wheel <- trash_wheel %>%
  mutate(
    IsHoliday = case_when(
      format(Date, "%m-%d") == "12-31" ~ TRUE,  # New Year's Eve
      format(Date, "%m-%d") == "07-04" ~ TRUE,  # Independence Day
      format(Date, "%m") == "02" & weekdays(Date) == "Sunday" & day(Date) <= 7 ~ TRUE,  # Super Bowl Sunday
      format(Date, "%m") == "11" & weekdays(Date) == "Friday" & as.integer(format(Date, "%d")) > 22 & as.integer(format(Date, "%d")) <= 28 ~ TRUE,  # Black Friday
      format(Date, "%m-%d") == "10-31" ~ TRUE,  # Halloween
      format(Date, "%m-%d") == "12-25" ~ TRUE,  # Christmas
      TRUE ~ FALSE  # Default to FALSE if none of the conditions are met
    )
  )
```

```{r}
trash_wheel <- trash_wheel %>%
  mutate(
    DayType = case_when(
      IsHoliday == TRUE ~ "Holiday",
      IsWeekend == TRUE ~ "Weekend",
      TRUE ~ "Weekday"
    )
  )
```

## Section 1

“How does the total volume of trash collected by Mr. Trash Wheel vary across different seasons?”

```{r}
seasonal_volume <- trash_wheel %>%
  group_by(Season, Year) %>%
  summarize(
    TotalVolume = sum(Volume, na.rm = TRUE)
  ) %>%
  ungroup()
```

```{r}
ggplot(
  seasonal_volume, 
  aes(
    x = Season, 
    y = TotalVolume, 
    fill = Season)
  ) +
  geom_boxplot() +
  labs(
    title = "Distribution of Trash Volume by Season",
    x = "Season",
    y = "Total Volume (Cubic Yards)",
    fill = "Season"
  ) +
  scale_fill_brewer(palette = "Dark2") +
  theme_minimal() 
```

```{r}
avg_seasonal_volume <- seasonal_volume %>%
  group_by(Season) %>%
  summarize(AverageVolume = mean(TotalVolume, na.rm = TRUE))
```

```{r}
avg_seasonal_volume %>% 
  gt() %>% 
  cols_label(AverageVolume = "Average Volume (Cubic Yards)") %>% 
  tab_header(
    title = "Trash Volume Collected", 
    subtitle = "seasonal comparison of the averege volume of trash collected")
```

## Section 2

“What types of trash are most common in each season, and which specific trash types show significant seasonal spikes?”

```{r}
composition <- trash_wheel %>%
  pivot_longer(
    cols = c(PlasticBottles, Polystyrene, CigaretteButts, GlassBottles, PlasticBags, Wrappers, SportsBalls),
    names_to = "TrashType",
    values_to = "Collected"
  )

seasonal_composition <- composition %>%
  group_by(Season, TrashType) %>%
  summarize(TotalCollected = sum(Collected, na.rm = TRUE)) %>%
  ungroup()

ggplot(seasonal_composition, aes(x = Season, y = TotalCollected, fill = TrashType)) +
  geom_bar(stat = "identity", position = "fill") +
  labs(
    title = "Trash Composition by Season (Mr. Trash Wheel)",
    x = "Season",
    y = "Proportion of Total Trash",
    fill = "Trash Type"
  ) +
  scale_fill_brewer(palette = "Dark2") +
  theme_minimal()
```

```{r}
ggplot(seasonal_composition, aes(x = Season, y = TrashType, fill = TotalCollected)) +
  geom_tile() +
  scale_fill_gradient(low = "lightblue", high = "darkblue") +
  labs(
    title = "Seasonal Peaks in Trash Types Collected",
    x = "Season",
    y = "Trash Type",
    fill = "Total Items Collected"
  ) +
  theme_minimal()
```

```{r}
type_by_season <- seasonal_composition %>%
  group_by(TrashType) %>%
  summarize(AverageCollected = round(mean(TotalCollected, na.rm = TRUE), 0))
```

```{r}
seasonal_ranks <- seasonal_composition %>%
  group_by(TrashType) %>%
  arrange(desc(TotalCollected)) %>% 
  mutate(
    Rank = row_number() 
  ) %>%
  ungroup()

seasonal_ranks_wide <- seasonal_ranks %>%
  pivot_wider(
    id_cols = TrashType,
    names_from = Rank,
    values_from = Season
    )
```

```{r}
seasonal_ranks_wide %>%
  gt() %>%
  cols_label(
    TrashType = "Trash Type",
    `1` = "Most Collected", 
    `2` = "2nd Most Collected", 
    `3` = "3rd Most Collected", 
    `4` = "Least Collected") %>%
  tab_header(
    title = "Ranking Trash Collection by Season",
    subtitle = "seasons ranked from having the highest and lowest collection of each trash type"
  )
```

## Section 3

“How does trash volume differ between regular weekdays, weekends, and specific holidays (e.g., 4th of July, Christmas)?”

```{r}
volume_on_type <- trash_wheel %>%
  group_by(DayType) %>%
  summarize(
    AverageTotalVolume = mean(Volume, na.rm = TRUE)
  )

ggplot(
  volume_on_type, 
  aes(
    x = AverageTotalVolume, 
    y = DayType, 
    fill = DayType)
  ) +
  geom_bar(stat = "identity", show.legend = FALSE) +
  labs(
    title = "Average Volume of Trash Collected by Day Type",
    x = "Day Type",
    y = "Average Volume (Cubic Yards)"
  ) +
  scale_fill_brewer(palette = "Dark2") +
  theme_minimal()
```

```{r}
composition_long <- trash_wheel %>%
  pivot_longer(
    cols = `PlasticBottles`:`SportsBalls`,
    names_to = "TrashType",
    values_to = "Collected"
  )

trash_day_type <- composition_long %>%
  group_by(DayType, TrashType) %>%
  summarize(AverageCollected = round(mean(Collected, na.rm = TRUE), 0)) %>%
  ungroup()

ggplot(trash_day_type, aes(x = TrashType, y = AverageCollected, fill = DayType)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(
    title = "Average Trash Collected by Day Type and Trash Type",
    x = "Trash Type",
    y = "Average Number Collected"
  ) +
  scale_fill_brewer(palette = "Dark2") +
  theme_minimal()
```

```{r}
trash_day_type %>% 
  pivot_wider(
    names_from = DayType, 
    values_from = AverageCollected
  ) %>%
  gt() %>% 
  cols_label(
    TrashType = "Trash Type"
  ) %>%
  tab_header(
    title = "Average Trash Collected by Day Type and Trash Type",
    subtitle = "Comparison Across Weekdays, Weekends, and Holidays"
  )
```

## Section 4

“How have seasonal patterns in trash volume and composition evolved over time, and what do these changes suggest about future trends in Baltimore’s littering behavior?”

```{r}
seasonal_overtime <- composition_long %>%
  group_by(Season, Year, TrashType) %>%
  summarize(
    TotalCollected = sum(Collected, na.rm = TRUE)
  ) %>%
  ungroup()

ggplot(
  seasonal_overtime, 
  aes(
    x = Year, 
    y = TotalCollected, 
    fill = TrashType)
  ) +
  geom_area(stat = "identity", position = "stack") +
  facet_wrap(~Season) +
  labs(
    title = "Seasonal Composition of Trash Over Time",
    x = "Year",
    y = "Total Number of Trash Collected",
    fill = "Trash Type"
  ) +
  scale_fill_brewer(palette = "Dark2") +
  theme_minimal()
```

## Conclusion

## Citations















